module.exports=[56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},91023,(a,b,c)=>{"use strict";b.exports=a.r(64194).vendored.contexts.AppRouterContext},71264,(a,b,c)=>{"use strict";b.exports=a.r(64194).vendored.contexts.HooksClientContext},31018,(a,b,c)=>{"use strict";b.exports=a.r(64194).vendored.contexts.ServerInsertedHtml},24361,(a,b,c)=>{b.exports=a.x("util",()=>require("util"))},14747,(a,b,c)=>{b.exports=a.x("path",()=>require("path"))},54799,(a,b,c)=>{b.exports=a.x("crypto",()=>require("crypto"))},59834,a=>{"use strict";a.i(37013);var b=a.i(56622),c=a.i(12972);let d={ORGANIZATIONS:"organizations",ORGANIZATION_MEMBERS:"organization_members",PROJECTS:"projects",ENVIRONMENTS:"environments",FEATURE_FLAGS:"feature_flags",FLAG_VALUES:"flag_values",API_KEYS:"api_keys",AUDIT_LOGS:"audit_logs",FLAG_ANALYTICS:"flag_analytics"};async function e(a){let e=await (0,b.addDoc)((0,b.collection)(c.db,d.ORGANIZATIONS),{...a,createdAt:(0,b.serverTimestamp)(),updatedAt:(0,b.serverTimestamp)()});return await (0,b.setDoc)((0,b.doc)(c.db,d.ORGANIZATION_MEMBERS,`${a.createdBy}_${e.id}`),{organizationId:e.id,userId:a.createdBy,role:"owner",createdAt:(0,b.serverTimestamp)()}),e.id}async function f(a){let e=(0,b.query)((0,b.collection)(c.db,d.ORGANIZATION_MEMBERS),(0,b.where)("userId","==",a)),f=(await (0,b.getDocs)(e)).docs.map(a=>a.data().organizationId);if(0===f.length)return[];let g=(0,b.query)((0,b.collection)(c.db,d.ORGANIZATIONS),(0,b.where)("__name__","in",f));return(await (0,b.getDocs)(g)).docs.map(a=>({id:a.id,...a.data()}))}async function g(a){let e=await (0,b.addDoc)((0,b.collection)(c.db,d.PROJECTS),{...a,createdAt:(0,b.serverTimestamp)(),updatedAt:(0,b.serverTimestamp)()});for(let a of[{name:"Development",key:"dev"},{name:"Staging",key:"staging"},{name:"Production",key:"prod"}])await (0,b.addDoc)((0,b.collection)(c.db,d.ENVIRONMENTS),{projectId:e.id,...a,createdAt:(0,b.serverTimestamp)(),updatedAt:(0,b.serverTimestamp)()});return e.id}async function h(a){let e=await (0,b.addDoc)((0,b.collection)(c.db,d.FEATURE_FLAGS),{...a,tags:a.tags||[],createdAt:(0,b.serverTimestamp)(),updatedAt:(0,b.serverTimestamp)()}),f=(0,b.query)((0,b.collection)(c.db,d.ENVIRONMENTS),(0,b.where)("projectId","==",a.projectId));for(let g of(await (0,b.getDocs)(f)).docs)await (0,b.addDoc)((0,b.collection)(c.db,d.FLAG_VALUES),{flagId:e.id,environmentId:g.id,enabled:!1,value:a.defaultValue,updatedAt:(0,b.serverTimestamp)()});return e}async function i(e){let f=(await a.A(71374)).default,g=Array.from(crypto.getRandomValues(new Uint8Array(16))).map(a=>a.toString(16).padStart(2,"0")).join(""),h=`fsk_${e.keyType}_${g}`,i=await f.hash(h,10),j=h.substring(0,12);return await (0,b.addDoc)((0,b.collection)(c.db,d.API_KEYS),{environmentId:e.environmentId,name:e.name,keyPrefix:j,keyHash:i,keyType:e.keyType,revoked:!1,lastUsedAt:null,createdAt:(0,b.serverTimestamp)(),createdBy:e.createdBy}),h}async function j(a){let e=(0,b.doc)(c.db,d.API_KEYS,a);await (0,b.updateDoc)(e,{revoked:!0,updatedAt:(0,b.serverTimestamp)()})}async function k(a){let e=(0,b.query)((0,b.collection)(c.db,d.API_KEYS),(0,b.where)("environmentId","==",a),(0,b.where)("revoked","==",!1));return(await (0,b.getDocs)(e)).docs.map(a=>({id:a.id,...a.data()}))}async function l(a){return await (0,b.addDoc)((0,b.collection)(c.db,d.AUDIT_LOGS),{...a,timestamp:(0,b.serverTimestamp)(),createdAt:(0,b.serverTimestamp)()})}async function m(a,e=100){let f=(0,b.query)((0,b.collection)(c.db,d.AUDIT_LOGS),(0,b.where)("organizationId","==",a));return(await (0,b.getDocs)(f)).docs.map(a=>({id:a.id,...a.data()})).sort((a,b)=>{let c=a.timestamp?.toMillis()||a.createdAt?.toMillis()||0;return(b.timestamp?.toMillis()||b.createdAt?.toMillis()||0)-c}).slice(0,e)}async function n(a,e,f=7){let g=(0,b.query)((0,b.collection)(c.db,d.FLAG_ANALYTICS),(0,b.where)("projectId","==",a),(0,b.where)("environmentId","==",e)),h=(await (0,b.getDocs)(g)).docs.map(a=>({id:a.id,...a.data()})),i=Date.now()-24*f*36e5;return h.filter(a=>(a.timestamp?.toMillis()||a.createdAt?.toMillis()||0)>=i)}async function o(a,b,c=7){let d=await n(a,b,c),e={};return d.forEach(a=>{let b=a.flagKey;e[b]||(e[b]={flagKey:b,flagId:a.flagId,evaluations:0,uniqueUsers:new Set,trueCount:0,falseCount:0,targetingAppliedCount:0}),e[b].evaluations++,a.userId&&e[b].uniqueUsers.add(a.userId),!0===a.result&&e[b].trueCount++,!1===a.result&&e[b].falseCount++,a.targetingApplied&&e[b].targetingAppliedCount++}),Object.values(e).map(a=>({...a,uniqueUsers:a.uniqueUsers.size}))}a.s(["COLLECTIONS",0,d,"createApiKey",()=>i,"createAuditLog",()=>l,"createFeatureFlag",()=>h,"createOrganization",()=>e,"createProject",()=>g,"getAggregatedAnalytics",()=>o,"getAuditLogs",()=>m,"getEnvironmentApiKeys",()=>k,"getUserOrganizations",()=>f,"revokeApiKey",()=>j])},58647,a=>{"use strict";var b=a.i(70888),c=a.i(21387);a.i(50402);var d=a.i(5107),e=a.i(12972),f=a.i(82059);a.i(37013);var g=a.i(56622),h=a.i(59834),i=a.i(94978);function j(){let a=(0,f.useParams)(),j=a.slug,k=a.projectKey,l=(0,f.useRouter)(),[m,n]=(0,c.useState)(null),[o,p]=(0,c.useState)(!0),[q,r]=(0,c.useState)(null),[s,t]=(0,c.useState)([]),[u,v]=(0,c.useState)(""),[w,x]=(0,c.useState)([]),[y,z]=(0,c.useState)([]),[A,B]=(0,c.useState)(!1),[C,D]=(0,c.useState)(null),[E,F]=(0,c.useState)({name:"",key:"",description:"",flagType:"boolean",defaultValue:!1}),[G,H]=(0,c.useState)(!1);(0,c.useEffect)(()=>{let a=(0,d.onAuthStateChanged)(e.auth,async a=>{a?(n(a),await I()):l.push("/login"),p(!1)});return()=>a()},[l,k]);let I=async()=>{try{let a=(0,g.query)((0,g.collection)(e.db,h.COLLECTIONS.PROJECTS),(0,g.where)("key","==",k)),b=await (0,g.getDocs)(a);if(b.empty)l.push(`/dashboard/${j}`);else{let a={id:b.docs[0].id,...b.docs[0].data()};r(a),await J(a.id),await K(a.id)}}catch(a){console.error("Error loading project:",a)}},J=async a=>{try{let b=(0,g.query)((0,g.collection)(e.db,h.COLLECTIONS.ENVIRONMENTS),(0,g.where)("projectId","==",a)),c=(await (0,g.getDocs)(b)).docs.map(a=>({id:a.id,...a.data()}));t(c),c.length>0&&v(c[0].id)}catch(a){console.error("Error loading environments:",a)}},K=async a=>{try{let b=(0,g.query)((0,g.collection)(e.db,h.COLLECTIONS.FEATURE_FLAGS),(0,g.where)("projectId","==",a)),c=(await (0,g.getDocs)(b)).docs.map(a=>({id:a.id,...a.data()}));x(c);let d=(0,g.query)((0,g.collection)(e.db,h.COLLECTIONS.FLAG_VALUES)),f=(await (0,g.getDocs)(d)).docs.map(a=>({id:a.id,...a.data()}));z(f)}catch(a){console.error("Error loading flags:",a)}},L=async a=>{if(a.preventDefault(),m&&q){H(!0);try{await (0,h.createFeatureFlag)({projectId:q.id,name:E.name,key:E.key,description:E.description,flagType:E.flagType,defaultValue:E.defaultValue,createdBy:m.uid}),i.default.success(`âœ… Flag "${E.name}" created successfully!`),F({name:"",key:"",description:"",flagType:"boolean",defaultValue:!1}),B(!1),await K(q.id)}catch(a){console.error("Error creating flag:",a),i.default.error(`âŒ Failed to create flag: ${a.message}`)}finally{H(!1)}}},M=async(a,b)=>{if(u&&m&&q){D(a);try{let c=y.find(b=>b.flagId===a&&b.environmentId===u),d=w.find(b=>b.id===a),f=!b;c&&d&&(await (0,g.updateDoc)((0,g.doc)(e.db,h.COLLECTIONS.FLAG_VALUES,c.id),{enabled:f,updatedAt:new Date}),await (0,h.createAuditLog)({organizationId:q.organizationId,projectId:q.id,environmentId:u,userId:m.uid,userEmail:m.email||"unknown",action:f?"FLAG_ENABLED":"FLAG_DISABLED",resourceType:"flag",resourceId:a,resourceName:d.name,changes:{before:{enabled:b},after:{enabled:f}}})),i.default.success(`${f?"âœ… Flag enabled":"â¸ï¸ Flag disabled"}`),await K(q.id)}catch(a){console.error("Error toggling flag:",a),i.default.error("âŒ Failed to toggle flag")}finally{D(null)}}},N=a=>y.find(b=>b.flagId===a&&b.environmentId===u);return o?(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,b.jsx)("div",{className:"text-gray-600",children:"YÃ¼kleniyor..."})}):q?(0,b.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,b.jsx)("nav",{className:"bg-white shadow",children:(0,b.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,b.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[(0,b.jsx)("button",{onClick:()=>l.push(`/dashboard/${j}`),className:"text-gray-600 hover:text-gray-900 text-sm sm:text-base",children:"â† Geri"}),(0,b.jsx)("h1",{className:"text-lg sm:text-xl font-bold text-gray-900 truncate max-w-[150px] sm:max-w-none",children:q.name})]}),(0,b.jsx)("div",{className:"flex items-center",children:(0,b.jsx)("span",{className:"text-gray-700 text-xs sm:text-sm truncate max-w-[120px] sm:max-w-none",children:m?.email})})]})})}),(0,b.jsx)("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:(0,b.jsxs)("div",{className:"px-4 py-6 sm:px-0",children:[(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Environment"}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:s.map(a=>(0,b.jsx)("button",{onClick:()=>v(a.id),className:`px-3 sm:px-4 py-2 rounded-md font-medium text-sm transition-colors ${u===a.id?"bg-blue-600 text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:a.name},a.id))})]}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-6",children:[(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4",children:[(0,b.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Feature Flags"}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,b.jsx)("button",{onClick:()=>l.push(`/dashboard/${j}/projects/${k}/api-keys`),className:"px-3 py-1 text-xs sm:text-sm bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 font-medium",children:"ðŸ”‘ API Keys"}),(0,b.jsx)("button",{onClick:()=>l.push(`/dashboard/${j}/projects/${k}/analytics`),className:"px-3 py-1 text-xs sm:text-sm bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200 font-medium",children:"ðŸ“Š Analytics"}),(0,b.jsx)("button",{onClick:()=>l.push(`/dashboard/${j}/audit-logs`),className:"px-3 py-1 text-xs sm:text-sm bg-purple-100 text-purple-700 rounded-md hover:bg-purple-200 font-medium",children:"ðŸ“‹ Audit Logs"})]})]}),(0,b.jsx)("button",{onClick:()=>B(!A),className:"w-full sm:w-auto px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-medium text-sm sm:text-base",children:A?"Ä°ptal":"+ Yeni Flag"})]}),A&&(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Yeni Feature Flag OluÅŸtur"}),(0,b.jsxs)("form",{onSubmit:L,className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Flag AdÄ±"}),(0,b.jsx)("input",{type:"text",required:!0,value:E.name,onChange:a=>{F({...E,name:a.target.value,key:a.target.value.toLowerCase().replace(/ÄŸ/g,"g").replace(/Ã¼/g,"u").replace(/ÅŸ/g,"s").replace(/Ä±/g,"i").replace(/Ã¶/g,"o").replace(/Ã§/g,"c").replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")})},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Dark Mode"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Flag Key"}),(0,b.jsx)("input",{type:"text",required:!0,value:E.key,onChange:a=>F({...E,key:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"dark-mode"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"AÃ§Ä±klama"}),(0,b.jsx)("textarea",{value:E.description,onChange:a=>F({...E,description:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Flag aÃ§Ä±klamasÄ±...",rows:2})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tip"}),(0,b.jsxs)("select",{value:E.flagType,onChange:a=>F({...E,flagType:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,b.jsx)("option",{value:"boolean",children:"Boolean (true/false)"}),(0,b.jsx)("option",{value:"number",children:"Number"}),(0,b.jsx)("option",{value:"json",children:"JSON"}),(0,b.jsx)("option",{value:"multivariate",children:"Multivariate"})]})]}),(0,b.jsx)("button",{type:"submit",disabled:G,className:"w-full px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 font-medium disabled:opacity-50",children:G?"OluÅŸturuluyor...":"OluÅŸtur"})]})]}),0===w.length?(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[(0,b.jsx)("p",{className:"text-gray-500 mb-4",children:"HenÃ¼z feature flag oluÅŸturmadÄ±nÄ±z."}),(0,b.jsx)("button",{onClick:()=>B(!0),className:"text-blue-600 hover:text-blue-700 font-medium",children:"Ä°lk flag'inizi oluÅŸturun â†’"})]}):(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,b.jsx)("div",{className:"hidden sm:block overflow-x-auto",children:(0,b.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,b.jsx)("thead",{className:"bg-gray-50",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Flag"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Key"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tip"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Durum"})]})}),(0,b.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:w.map(c=>{let d=N(c.id),e=d?.enabled||!1;return(0,b.jsxs)("tr",{className:"hover:bg-gray-50 cursor-pointer",children:[(0,b.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",onClick:()=>l.push(`/dashboard/${a.slug}/projects/${a.projectKey}/flags/${c.key}`),children:[(0,b.jsx)("div",{className:"text-sm font-medium text-gray-900 hover:text-blue-600",children:c.name}),c.description&&(0,b.jsx)("div",{className:"text-sm text-gray-500",children:c.description})]}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",onClick:()=>l.push(`/dashboard/${a.slug}/projects/${a.projectKey}/flags/${c.key}`),children:(0,b.jsx)("code",{className:"text-sm text-gray-600 bg-gray-100 px-2 py-1 rounded",children:c.key})}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",onClick:()=>l.push(`/dashboard/${a.slug}/projects/${a.projectKey}/flags/${c.key}`),children:(0,b.jsx)("span",{className:"text-sm text-gray-500",children:c.flagType})}),(0,b.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,b.jsx)("button",{onClick:a=>{a.stopPropagation(),M(c.id,e)},disabled:C===c.id,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors disabled:opacity-50 disabled:cursor-not-allowed ${e?"bg-green-600":"bg-gray-300"}`,children:C===c.id?(0,b.jsx)("span",{className:"inline-block h-4 w-4 rounded-full bg-white animate-pulse mx-auto"}):(0,b.jsx)("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${e?"translate-x-6":"translate-x-1"}`})}),(0,b.jsx)("span",{className:"ml-3 text-sm text-gray-600",children:C===c.id?"Updating...":e?"Aktif":"Pasif"})]})]},c.id)})})]})}),(0,b.jsx)("div",{className:"sm:hidden divide-y divide-gray-200",children:w.map(c=>{let d=N(c.id),e=d?.enabled||!1;return(0,b.jsxs)("div",{onClick:()=>l.push(`/dashboard/${a.slug}/projects/${a.projectKey}/flags/${c.key}`),className:"p-4 hover:bg-gray-50 cursor-pointer",children:[(0,b.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("div",{className:"text-sm font-medium text-gray-900 truncate",children:c.name}),c.description&&(0,b.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:c.description}),(0,b.jsx)("code",{className:"text-xs text-gray-600 bg-gray-100 px-2 py-1 rounded mt-1 inline-block",children:c.key})]}),(0,b.jsx)("button",{onClick:a=>{a.stopPropagation(),M(c.id,e)},disabled:C===c.id,className:`ml-3 relative inline-flex h-6 w-11 flex-shrink-0 items-center rounded-full transition-colors disabled:opacity-50 ${e?"bg-green-600":"bg-gray-300"}`,children:C===c.id?(0,b.jsx)("span",{className:"inline-block h-4 w-4 rounded-full bg-white animate-pulse mx-auto"}):(0,b.jsx)("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${e?"translate-x-6":"translate-x-1"}`})})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,b.jsx)("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 rounded",children:c.flagType}),(0,b.jsx)("span",{className:`px-2 py-1 rounded ${e?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:C===c.id?"Updating...":e?"âœ“ Aktif":"âœ— Pasif"})]})]},c.id)})})]})]})})]}):null}a.s(["default",()=>j])},71374,a=>{a.v(b=>Promise.all(["server/chunks/ssr/b3668_bcryptjs_index_cf2819b8.js"].map(b=>a.l(b))).then(()=>b(13954)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__5f47f417._.js.map