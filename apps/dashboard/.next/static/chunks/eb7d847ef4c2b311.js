(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,70683,(e,t,a)=>{t.exports=e.r(51437)},14493,e=>{"use strict";e.i(28599);var t=e.i(28961),a=e.i(29281);let r={ORGANIZATIONS:"organizations",ORGANIZATION_MEMBERS:"organization_members",PROJECTS:"projects",ENVIRONMENTS:"environments",FEATURE_FLAGS:"feature_flags",FLAG_VALUES:"flag_values",API_KEYS:"api_keys",AUDIT_LOGS:"audit_logs",FLAG_ANALYTICS:"flag_analytics"};async function s(e){let s=await (0,t.addDoc)((0,t.collection)(a.db,r.ORGANIZATIONS),{...e,createdAt:(0,t.serverTimestamp)(),updatedAt:(0,t.serverTimestamp)()});return await (0,t.setDoc)((0,t.doc)(a.db,r.ORGANIZATION_MEMBERS,`${e.createdBy}_${s.id}`),{organizationId:s.id,userId:e.createdBy,role:"owner",createdAt:(0,t.serverTimestamp)()}),s.id}async function i(e){let s=(0,t.query)((0,t.collection)(a.db,r.ORGANIZATION_MEMBERS),(0,t.where)("userId","==",e)),i=(await (0,t.getDocs)(s)).docs.map(e=>e.data().organizationId);if(0===i.length)return[];let n=(0,t.query)((0,t.collection)(a.db,r.ORGANIZATIONS),(0,t.where)("__name__","in",i));return(await (0,t.getDocs)(n)).docs.map(e=>({id:e.id,...e.data()}))}async function n(e){let s=await (0,t.addDoc)((0,t.collection)(a.db,r.PROJECTS),{...e,createdAt:(0,t.serverTimestamp)(),updatedAt:(0,t.serverTimestamp)()});for(let e of[{name:"Development",key:"dev"},{name:"Staging",key:"staging"},{name:"Production",key:"prod"}])await (0,t.addDoc)((0,t.collection)(a.db,r.ENVIRONMENTS),{projectId:s.id,...e,createdAt:(0,t.serverTimestamp)(),updatedAt:(0,t.serverTimestamp)()});return s.id}async function l(e){let s=await (0,t.addDoc)((0,t.collection)(a.db,r.FEATURE_FLAGS),{...e,tags:e.tags||[],createdAt:(0,t.serverTimestamp)(),updatedAt:(0,t.serverTimestamp)()}),i=(0,t.query)((0,t.collection)(a.db,r.ENVIRONMENTS),(0,t.where)("projectId","==",e.projectId));for(let n of(await (0,t.getDocs)(i)).docs)await (0,t.addDoc)((0,t.collection)(a.db,r.FLAG_VALUES),{flagId:s.id,environmentId:n.id,enabled:!1,value:e.defaultValue,updatedAt:(0,t.serverTimestamp)()});return s}async function o(s){let i=(await e.A(43979)).default,n=Array.from(crypto.getRandomValues(new Uint8Array(16))).map(e=>e.toString(16).padStart(2,"0")).join(""),l=`fsk_${s.keyType}_${n}`,o=await i.hash(l,10),d=l.substring(0,12);return await (0,t.addDoc)((0,t.collection)(a.db,r.API_KEYS),{environmentId:s.environmentId,name:s.name,keyPrefix:d,keyHash:o,keyType:s.keyType,revoked:!1,lastUsedAt:null,createdAt:(0,t.serverTimestamp)(),createdBy:s.createdBy}),l}async function d(e){let s=(0,t.doc)(a.db,r.API_KEYS,e);await (0,t.updateDoc)(s,{revoked:!0,updatedAt:(0,t.serverTimestamp)()})}async function c(e){let s=(0,t.query)((0,t.collection)(a.db,r.API_KEYS),(0,t.where)("environmentId","==",e),(0,t.where)("revoked","==",!1));return(await (0,t.getDocs)(s)).docs.map(e=>({id:e.id,...e.data()}))}async function u(e){return await (0,t.addDoc)((0,t.collection)(a.db,r.AUDIT_LOGS),{...e,timestamp:(0,t.serverTimestamp)(),createdAt:(0,t.serverTimestamp)()})}async function m(e,s=100){let i=(0,t.query)((0,t.collection)(a.db,r.AUDIT_LOGS),(0,t.where)("organizationId","==",e));return(await (0,t.getDocs)(i)).docs.map(e=>({id:e.id,...e.data()})).sort((e,t)=>{let a=e.timestamp?.toMillis()||e.createdAt?.toMillis()||0;return(t.timestamp?.toMillis()||t.createdAt?.toMillis()||0)-a}).slice(0,s)}async function g(e,s,i=7){let n=(0,t.query)((0,t.collection)(a.db,r.FLAG_ANALYTICS),(0,t.where)("projectId","==",e),(0,t.where)("environmentId","==",s)),l=(await (0,t.getDocs)(n)).docs.map(e=>({id:e.id,...e.data()})),o=Date.now()-24*i*36e5;return l.filter(e=>(e.timestamp?.toMillis()||e.createdAt?.toMillis()||0)>=o)}async function p(e,t,a=7){let r=await g(e,t,a),s={};return r.forEach(e=>{let t=e.flagKey;s[t]||(s[t]={flagKey:t,flagId:e.flagId,evaluations:0,uniqueUsers:new Set,trueCount:0,falseCount:0,targetingAppliedCount:0}),s[t].evaluations++,e.userId&&s[t].uniqueUsers.add(e.userId),!0===e.result&&s[t].trueCount++,!1===e.result&&s[t].falseCount++,e.targetingApplied&&s[t].targetingAppliedCount++}),Object.values(s).map(e=>({...e,uniqueUsers:e.uniqueUsers.size}))}e.s(["COLLECTIONS",0,r,"createApiKey",()=>o,"createAuditLog",()=>u,"createFeatureFlag",()=>l,"createOrganization",()=>s,"createProject",()=>n,"getAggregatedAnalytics",()=>p,"getAuditLogs",()=>m,"getEnvironmentApiKeys",()=>c,"getUserOrganizations",()=>i,"revokeApiKey",()=>d])},87842,e=>{"use strict";var t=e.i(83769),a=e.i(91672);e.i(32555);var r=e.i(79457),s=e.i(29281),i=e.i(70683),n=e.i(14493);function l(){let[e,l]=(0,a.useState)(null),[o,d]=(0,a.useState)(!0),[c,u]=(0,a.useState)([]),[m,g]=(0,a.useState)(!1),[p,h]=(0,a.useState)({name:"",slug:""}),[x,y]=(0,a.useState)(!1),f=(0,i.useRouter)();(0,a.useEffect)(()=>{let e=(0,r.onAuthStateChanged)(s.auth,async e=>{e?(l(e),await b(e.uid)):f.push("/login"),d(!1)});return()=>e()},[f]);let b=async e=>{try{let t=await (0,n.getUserOrganizations)(e);u(t)}catch(e){console.error("Error loading organizations:",e)}},A=async()=>{try{await (0,r.signOut)(s.auth),f.push("/login")}catch(e){console.error("Logout error:",e)}},v=async t=>{if(t.preventDefault(),e){y(!0);try{await (0,n.createOrganization)({name:p.name,slug:p.slug,createdBy:e.uid}),h({name:"",slug:""}),g(!1),await b(e.uid)}catch(e){console.error("Error creating organization:",e),alert("Hata: "+e.message)}finally{y(!1)}}};return o?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)("div",{className:"text-gray-600",children:"Yükleniyor..."})}):(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)("nav",{className:"bg-white shadow",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex justify-between h-16",children:[(0,t.jsx)("div",{className:"flex items-center",children:(0,t.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"Flagship Dashboard"})}),(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)("span",{className:"text-gray-700",children:e?.email}),(0,t.jsx)("button",{onClick:A,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md",children:"Çıkış Yap"})]})]})})}),(0,t.jsx)("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"px-4 py-6 sm:px-0",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Organizations"}),(0,t.jsx)("button",{onClick:()=>g(!m),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-medium",children:m?"İptal":"+ Yeni Organization"})]}),m&&(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Yeni Organization Oluştur"}),(0,t.jsxs)("form",{onSubmit:v,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Organization Adı"}),(0,t.jsx)("input",{type:"text",required:!0,value:p.name,onChange:e=>{h({name:e.target.value,slug:e.target.value.toLowerCase().replace(/ğ/g,"g").replace(/ü/g,"u").replace(/ş/g,"s").replace(/ı/g,"i").replace(/ö/g,"o").replace(/ç/g,"c").replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")})},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Şirket Adı"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Slug (URL)"}),(0,t.jsx)("input",{type:"text",required:!0,value:p.slug,onChange:e=>h({...p,slug:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"sirket-adi"}),(0,t.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["URL: flagship.com/",p.slug||"slug"]})]}),(0,t.jsx)("button",{type:"submit",disabled:x,className:"w-full px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 font-medium disabled:opacity-50",children:x?"Oluşturuluyor...":"Oluştur"})]})]}),0===c.length?(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[(0,t.jsx)("p",{className:"text-gray-500 mb-4",children:"Henüz organization oluşturmadınız."}),(0,t.jsx)("button",{onClick:()=>g(!0),className:"text-blue-600 hover:text-blue-700 font-medium",children:"İlk organization'ınızı oluşturun →"})]}):(0,t.jsx)("div",{className:"grid gap-4",children:c.map(e=>(0,t.jsx)("div",{className:"bg-white rounded-lg shadow p-6 hover:shadow-md transition-shadow cursor-pointer",onClick:()=>f.push(`/dashboard/${e.slug}`),children:(0,t.jsxs)("div",{className:"flex justify-between items-start",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e.name}),(0,t.jsxs)("p",{className:"text-sm text-gray-500",children:["/",e.slug]})]}),(0,t.jsx)("span",{className:"text-xs text-gray-400",children:e.createdAt?.toDate?.()?.toLocaleDateString("tr-TR")||"Yeni"})]})},e.id))})]})})]})}e.s(["default",()=>l])},43979,e=>{e.v(t=>Promise.all(["static/chunks/405394a8b91a97fb.js"].map(t=>e.l(t))).then(()=>t(27430)))}]);