(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,70683,(e,t,a)=>{t.exports=e.r(51437)},14493,e=>{"use strict";e.i(28599);var t=e.i(28961),a=e.i(29281);let s={ORGANIZATIONS:"organizations",ORGANIZATION_MEMBERS:"organization_members",PROJECTS:"projects",ENVIRONMENTS:"environments",FEATURE_FLAGS:"feature_flags",FLAG_VALUES:"flag_values",API_KEYS:"api_keys",AUDIT_LOGS:"audit_logs",FLAG_ANALYTICS:"flag_analytics"};async function r(e){let r=await (0,t.addDoc)((0,t.collection)(a.db,s.ORGANIZATIONS),{...e,createdAt:(0,t.serverTimestamp)(),updatedAt:(0,t.serverTimestamp)()});return await (0,t.setDoc)((0,t.doc)(a.db,s.ORGANIZATION_MEMBERS,`${e.createdBy}_${r.id}`),{organizationId:r.id,userId:e.createdBy,role:"owner",createdAt:(0,t.serverTimestamp)()}),r.id}async function l(e){let r=(0,t.query)((0,t.collection)(a.db,s.ORGANIZATION_MEMBERS),(0,t.where)("userId","==",e)),l=(await (0,t.getDocs)(r)).docs.map(e=>e.data().organizationId);if(0===l.length)return[];let i=(0,t.query)((0,t.collection)(a.db,s.ORGANIZATIONS),(0,t.where)("__name__","in",l));return(await (0,t.getDocs)(i)).docs.map(e=>({id:e.id,...e.data()}))}async function i(e){let r=await (0,t.addDoc)((0,t.collection)(a.db,s.PROJECTS),{...e,createdAt:(0,t.serverTimestamp)(),updatedAt:(0,t.serverTimestamp)()});for(let e of[{name:"Development",key:"dev"},{name:"Staging",key:"staging"},{name:"Production",key:"prod"}])await (0,t.addDoc)((0,t.collection)(a.db,s.ENVIRONMENTS),{projectId:r.id,...e,createdAt:(0,t.serverTimestamp)(),updatedAt:(0,t.serverTimestamp)()});return r.id}async function n(e){let r=await (0,t.addDoc)((0,t.collection)(a.db,s.FEATURE_FLAGS),{...e,tags:e.tags||[],createdAt:(0,t.serverTimestamp)(),updatedAt:(0,t.serverTimestamp)()}),l=(0,t.query)((0,t.collection)(a.db,s.ENVIRONMENTS),(0,t.where)("projectId","==",e.projectId));for(let i of(await (0,t.getDocs)(l)).docs)await (0,t.addDoc)((0,t.collection)(a.db,s.FLAG_VALUES),{flagId:r.id,environmentId:i.id,enabled:!1,value:e.defaultValue,updatedAt:(0,t.serverTimestamp)()});return r}async function d(r){let l=(await e.A(43979)).default,i=Array.from(crypto.getRandomValues(new Uint8Array(16))).map(e=>e.toString(16).padStart(2,"0")).join(""),n=`fsk_${r.keyType}_${i}`,d=await l.hash(n,10),o=n.substring(0,12);return await (0,t.addDoc)((0,t.collection)(a.db,s.API_KEYS),{environmentId:r.environmentId,name:r.name,keyPrefix:o,keyHash:d,keyType:r.keyType,revoked:!1,lastUsedAt:null,createdAt:(0,t.serverTimestamp)(),createdBy:r.createdBy}),n}async function o(e){let r=(0,t.doc)(a.db,s.API_KEYS,e);await (0,t.updateDoc)(r,{revoked:!0,updatedAt:(0,t.serverTimestamp)()})}async function c(e){let r=(0,t.query)((0,t.collection)(a.db,s.API_KEYS),(0,t.where)("environmentId","==",e),(0,t.where)("revoked","==",!1));return(await (0,t.getDocs)(r)).docs.map(e=>({id:e.id,...e.data()}))}async function u(e){return await (0,t.addDoc)((0,t.collection)(a.db,s.AUDIT_LOGS),{...e,timestamp:(0,t.serverTimestamp)(),createdAt:(0,t.serverTimestamp)()})}async function m(e,r=100){let l=(0,t.query)((0,t.collection)(a.db,s.AUDIT_LOGS),(0,t.where)("organizationId","==",e));return(await (0,t.getDocs)(l)).docs.map(e=>({id:e.id,...e.data()})).sort((e,t)=>{let a=e.timestamp?.toMillis()||e.createdAt?.toMillis()||0;return(t.timestamp?.toMillis()||t.createdAt?.toMillis()||0)-a}).slice(0,r)}async function p(e,r,l=7){let i=(0,t.query)((0,t.collection)(a.db,s.FLAG_ANALYTICS),(0,t.where)("projectId","==",e),(0,t.where)("environmentId","==",r)),n=(await (0,t.getDocs)(i)).docs.map(e=>({id:e.id,...e.data()})),d=Date.now()-24*l*36e5;return n.filter(e=>(e.timestamp?.toMillis()||e.createdAt?.toMillis()||0)>=d)}async function x(e,t,a=7){let s=await p(e,t,a),r={};return s.forEach(e=>{let t=e.flagKey;r[t]||(r[t]={flagKey:t,flagId:e.flagId,evaluations:0,uniqueUsers:new Set,trueCount:0,falseCount:0,targetingAppliedCount:0}),r[t].evaluations++,e.userId&&r[t].uniqueUsers.add(e.userId),!0===e.result&&r[t].trueCount++,!1===e.result&&r[t].falseCount++,e.targetingApplied&&r[t].targetingAppliedCount++}),Object.values(r).map(e=>({...e,uniqueUsers:e.uniqueUsers.size}))}e.s(["COLLECTIONS",0,s,"createApiKey",()=>d,"createAuditLog",()=>u,"createFeatureFlag",()=>n,"createOrganization",()=>r,"createProject",()=>i,"getAggregatedAnalytics",()=>x,"getAuditLogs",()=>m,"getEnvironmentApiKeys",()=>c,"getUserOrganizations",()=>l,"revokeApiKey",()=>o])},54633,e=>{"use strict";var t=e.i(83769),a=e.i(91672);e.i(32555);var s=e.i(79457),r=e.i(29281),l=e.i(70683);e.i(28599);var i=e.i(28961),n=e.i(14493),d=e.i(1040);function o(){let e=(0,l.useParams)(),o=e.slug,c=e.projectKey,u=(0,l.useRouter)(),[m,p]=(0,a.useState)(null),[x,g]=(0,a.useState)(!0),[h,y]=(0,a.useState)(null),[f,b]=(0,a.useState)([]),[j,v]=(0,a.useState)(""),[N,w]=(0,a.useState)([]),[A,k]=(0,a.useState)([]),[I,T]=(0,a.useState)(!1),[S,E]=(0,a.useState)(null),[C,O]=(0,a.useState)({name:"",key:"",description:"",flagType:"boolean",defaultValue:!1}),[L,_]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let e=(0,s.onAuthStateChanged)(r.auth,async e=>{e?(p(e),await $()):u.push("/login"),g(!1)});return()=>e()},[u,c]);let $=async()=>{try{let e=(0,i.query)((0,i.collection)(r.db,n.COLLECTIONS.PROJECTS),(0,i.where)("key","==",c)),t=await (0,i.getDocs)(e);if(t.empty)u.push(`/dashboard/${o}`);else{let e={id:t.docs[0].id,...t.docs[0].data()};y(e),await D(e.id),await F(e.id)}}catch(e){console.error("Error loading project:",e)}},D=async e=>{try{let t=(0,i.query)((0,i.collection)(r.db,n.COLLECTIONS.ENVIRONMENTS),(0,i.where)("projectId","==",e)),a=(await (0,i.getDocs)(t)).docs.map(e=>({id:e.id,...e.data()}));b(a),a.length>0&&v(a[0].id)}catch(e){console.error("Error loading environments:",e)}},F=async e=>{try{let t=(0,i.query)((0,i.collection)(r.db,n.COLLECTIONS.FEATURE_FLAGS),(0,i.where)("projectId","==",e)),a=(await (0,i.getDocs)(t)).docs.map(e=>({id:e.id,...e.data()}));w(a);let s=(0,i.query)((0,i.collection)(r.db,n.COLLECTIONS.FLAG_VALUES)),l=(await (0,i.getDocs)(s)).docs.map(e=>({id:e.id,...e.data()}));k(l)}catch(e){console.error("Error loading flags:",e)}},R=async e=>{if(e.preventDefault(),m&&h){_(!0);try{await (0,n.createFeatureFlag)({projectId:h.id,name:C.name,key:C.key,description:C.description,flagType:C.flagType,defaultValue:C.defaultValue,createdBy:m.uid}),d.default.success(`âœ… Flag "${C.name}" created successfully!`),O({name:"",key:"",description:"",flagType:"boolean",defaultValue:!1}),T(!1),await F(h.id)}catch(e){console.error("Error creating flag:",e),d.default.error(`âŒ Failed to create flag: ${e.message}`)}finally{_(!1)}}},G=async(e,t)=>{if(j&&m&&h){E(e);try{let a=A.find(t=>t.flagId===e&&t.environmentId===j),s=N.find(t=>t.id===e),l=!t;a&&s&&(await (0,i.updateDoc)((0,i.doc)(r.db,n.COLLECTIONS.FLAG_VALUES,a.id),{enabled:l,updatedAt:new Date}),await (0,n.createAuditLog)({organizationId:h.organizationId,projectId:h.id,environmentId:j,userId:m.uid,userEmail:m.email||"unknown",action:l?"FLAG_ENABLED":"FLAG_DISABLED",resourceType:"flag",resourceId:e,resourceName:s.name,changes:{before:{enabled:t},after:{enabled:l}}})),d.default.success(`${l?"âœ… Flag enabled":"â¸ï¸ Flag disabled"}`),await F(h.id)}catch(e){console.error("Error toggling flag:",e),d.default.error("âŒ Failed to toggle flag")}finally{E(null)}}},U=e=>A.find(t=>t.flagId===e&&t.environmentId===j);return x?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)("div",{className:"text-gray-600",children:"YÃ¼kleniyor..."})}):h?(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)("nav",{className:"bg-white shadow",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[(0,t.jsx)("button",{onClick:()=>u.push(`/dashboard/${o}`),className:"text-gray-600 hover:text-gray-900 text-sm sm:text-base",children:"â† Geri"}),(0,t.jsx)("h1",{className:"text-lg sm:text-xl font-bold text-gray-900 truncate max-w-[150px] sm:max-w-none",children:h.name})]}),(0,t.jsx)("div",{className:"flex items-center",children:(0,t.jsx)("span",{className:"text-gray-700 text-xs sm:text-sm truncate max-w-[120px] sm:max-w-none",children:m?.email})})]})})}),(0,t.jsx)("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"px-4 py-6 sm:px-0",children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Environment"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:f.map(e=>(0,t.jsx)("button",{onClick:()=>v(e.id),className:`px-3 sm:px-4 py-2 rounded-md font-medium text-sm transition-colors ${j===e.id?"bg-blue-600 text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:e.name},e.id))})]}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-6",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4",children:[(0,t.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Feature Flags"}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,t.jsx)("button",{onClick:()=>u.push(`/dashboard/${o}/projects/${c}/api-keys`),className:"px-3 py-1 text-xs sm:text-sm bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 font-medium",children:"ðŸ”‘ API Keys"}),(0,t.jsx)("button",{onClick:()=>u.push(`/dashboard/${o}/projects/${c}/analytics`),className:"px-3 py-1 text-xs sm:text-sm bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200 font-medium",children:"ðŸ“Š Analytics"}),(0,t.jsx)("button",{onClick:()=>u.push(`/dashboard/${o}/audit-logs`),className:"px-3 py-1 text-xs sm:text-sm bg-purple-100 text-purple-700 rounded-md hover:bg-purple-200 font-medium",children:"ðŸ“‹ Audit Logs"})]})]}),(0,t.jsx)("button",{onClick:()=>T(!I),className:"w-full sm:w-auto px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-medium text-sm sm:text-base",children:I?"Ä°ptal":"+ Yeni Flag"})]}),I&&(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Yeni Feature Flag OluÅŸtur"}),(0,t.jsxs)("form",{onSubmit:R,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Flag AdÄ±"}),(0,t.jsx)("input",{type:"text",required:!0,value:C.name,onChange:e=>{O({...C,name:e.target.value,key:e.target.value.toLowerCase().replace(/ÄŸ/g,"g").replace(/Ã¼/g,"u").replace(/ÅŸ/g,"s").replace(/Ä±/g,"i").replace(/Ã¶/g,"o").replace(/Ã§/g,"c").replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")})},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Dark Mode"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Flag Key"}),(0,t.jsx)("input",{type:"text",required:!0,value:C.key,onChange:e=>O({...C,key:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"dark-mode"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"AÃ§Ä±klama"}),(0,t.jsx)("textarea",{value:C.description,onChange:e=>O({...C,description:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Flag aÃ§Ä±klamasÄ±...",rows:2})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tip"}),(0,t.jsxs)("select",{value:C.flagType,onChange:e=>O({...C,flagType:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,t.jsx)("option",{value:"boolean",children:"Boolean (true/false)"}),(0,t.jsx)("option",{value:"number",children:"Number"}),(0,t.jsx)("option",{value:"json",children:"JSON"}),(0,t.jsx)("option",{value:"multivariate",children:"Multivariate"})]})]}),(0,t.jsx)("button",{type:"submit",disabled:L,className:"w-full px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 font-medium disabled:opacity-50",children:L?"OluÅŸturuluyor...":"OluÅŸtur"})]})]}),0===N.length?(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[(0,t.jsx)("p",{className:"text-gray-500 mb-4",children:"HenÃ¼z feature flag oluÅŸturmadÄ±nÄ±z."}),(0,t.jsx)("button",{onClick:()=>T(!0),className:"text-blue-600 hover:text-blue-700 font-medium",children:"Ä°lk flag'inizi oluÅŸturun â†’"})]}):(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,t.jsx)("div",{className:"hidden sm:block overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Flag"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Key"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tip"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Durum"})]})}),(0,t.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:N.map(a=>{let s=U(a.id),r=s?.enabled||!1;return(0,t.jsxs)("tr",{className:"hover:bg-gray-50 cursor-pointer",children:[(0,t.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",onClick:()=>u.push(`/dashboard/${e.slug}/projects/${e.projectKey}/flags/${a.key}`),children:[(0,t.jsx)("div",{className:"text-sm font-medium text-gray-900 hover:text-blue-600",children:a.name}),a.description&&(0,t.jsx)("div",{className:"text-sm text-gray-500",children:a.description})]}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",onClick:()=>u.push(`/dashboard/${e.slug}/projects/${e.projectKey}/flags/${a.key}`),children:(0,t.jsx)("code",{className:"text-sm text-gray-600 bg-gray-100 px-2 py-1 rounded",children:a.key})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",onClick:()=>u.push(`/dashboard/${e.slug}/projects/${e.projectKey}/flags/${a.key}`),children:(0,t.jsx)("span",{className:"text-sm text-gray-500",children:a.flagType})}),(0,t.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,t.jsx)("button",{onClick:e=>{e.stopPropagation(),G(a.id,r)},disabled:S===a.id,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors disabled:opacity-50 disabled:cursor-not-allowed ${r?"bg-green-600":"bg-gray-300"}`,children:S===a.id?(0,t.jsx)("span",{className:"inline-block h-4 w-4 rounded-full bg-white animate-pulse mx-auto"}):(0,t.jsx)("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${r?"translate-x-6":"translate-x-1"}`})}),(0,t.jsx)("span",{className:"ml-3 text-sm text-gray-600",children:S===a.id?"Updating...":r?"Aktif":"Pasif"})]})]},a.id)})})]})}),(0,t.jsx)("div",{className:"sm:hidden divide-y divide-gray-200",children:N.map(a=>{let s=U(a.id),r=s?.enabled||!1;return(0,t.jsxs)("div",{onClick:()=>u.push(`/dashboard/${e.slug}/projects/${e.projectKey}/flags/${a.key}`),className:"p-4 hover:bg-gray-50 cursor-pointer",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("div",{className:"text-sm font-medium text-gray-900 truncate",children:a.name}),a.description&&(0,t.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:a.description}),(0,t.jsx)("code",{className:"text-xs text-gray-600 bg-gray-100 px-2 py-1 rounded mt-1 inline-block",children:a.key})]}),(0,t.jsx)("button",{onClick:e=>{e.stopPropagation(),G(a.id,r)},disabled:S===a.id,className:`ml-3 relative inline-flex h-6 w-11 flex-shrink-0 items-center rounded-full transition-colors disabled:opacity-50 ${r?"bg-green-600":"bg-gray-300"}`,children:S===a.id?(0,t.jsx)("span",{className:"inline-block h-4 w-4 rounded-full bg-white animate-pulse mx-auto"}):(0,t.jsx)("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${r?"translate-x-6":"translate-x-1"}`})})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,t.jsx)("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 rounded",children:a.flagType}),(0,t.jsx)("span",{className:`px-2 py-1 rounded ${r?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:S===a.id?"Updating...":r?"âœ“ Aktif":"âœ— Pasif"})]})]},a.id)})})]})]})})]}):null}e.s(["default",()=>o])},43979,e=>{e.v(t=>Promise.all(["static/chunks/405394a8b91a97fb.js"].map(t=>e.l(t))).then(()=>t(27430)))}]);